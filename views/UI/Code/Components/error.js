var Tooltip = require('../../Tooltip/Tooltip'),
    subview = require('subview'),
    click   = require('onclick');

require("./error.less");

var Err = Tooltip.extend('Code-Error', {
        init: function() {
            this.$arrow.addClass('Code-Error-arrow');
        }
    }),
    error;

click.anywhere(function() {
    if(error) {
        error.remove();
    }
});

module.exports = function(msg) {
    var self = this;

    this.trigger('error', [this, msg]);

    if(error) {
        error.remove();
    }
    
    //Wait for animation
    setTimeout(function() {
        error = Err.spawn({
            msg:  msg,
            $el:  self.$wrapper
        });
    }, 300);
    
    return error;
};
